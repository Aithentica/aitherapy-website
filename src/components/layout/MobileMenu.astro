---
import { mainNavigation } from '../../data/navigation';
---

<div class="hidden lg:hidden border-t border-gray-100" id="mobile-menu">
  <nav class="px-4 py-4 space-y-1" aria-label="Menu mobilne">
    {mainNavigation.map((item, index) => (
      item.children ? (
        <div class="mobile-dropdown">
          <button
            type="button"
            class="flex items-center justify-between w-full px-3 py-2.5 text-sm font-medium text-gray-700 hover:text-sage-600 rounded-lg transition-colors"
            data-dropdown-toggle={`mobile-dropdown-${index}`}
          >
            {item.label}
            <svg class="w-4 h-4 transition-transform dropdown-arrow" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
            </svg>
          </button>
          <div class="hidden pl-4 space-y-1" id={`mobile-dropdown-${index}`}>
            {item.children.map((child) => (
              <a
                href={child.href}
                class="block px-3 py-2 text-sm text-gray-600 hover:text-sage-600 rounded-lg transition-colors"
                {...(child.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
              >
                {child.label}
              </a>
            ))}
          </div>
        </div>
      ) : (
        <a
          href={item.href}
          class="block px-3 py-2.5 text-sm font-medium text-gray-700 hover:text-sage-600 rounded-lg transition-colors"
          {...(item.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
        >
          {item.label}
        </a>
      )
    ))}

    <div class="pt-3 border-t border-gray-100">
      <a
        href="https://app.aitherapy.support"
        target="_blank"
        rel="noopener noreferrer"
        class="block w-full text-center px-5 py-2.5 rounded-full bg-sage-600 text-white font-semibold text-sm hover:bg-sage-700 transition-colors"
      >
        Logowanie
      </a>
    </div>
  </nav>
</div>

<script is:inline>
  document.querySelectorAll('[data-dropdown-toggle]').forEach((btn) => {
    btn.addEventListener('click', () => {
      const targetId = btn.getAttribute('data-dropdown-toggle');
      const target = document.getElementById(targetId);
      const arrow = btn.querySelector('.dropdown-arrow');
      target.classList.toggle('hidden');
      arrow.classList.toggle('rotate-180');
    });
  });
</script>
