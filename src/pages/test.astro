---
import BaseLayout from '../layouts/BaseLayout.astro';
import { mainNavigation } from '../data/navigation';
import { features } from '../data/features';
import { testimonials } from '../data/testimonials';
import { faqItems } from '../data/faq';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog', ({ data }) => !data.draft);
const latestPosts = allPosts
  .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())
  .slice(0, 3);

const currentYear = new Date().getFullYear();
---

<BaseLayout
  title="Therapy Support"
  description="Zintegrowana Platforma dla Terapeutów CBT. Nowy standard w psychoterapii."
  noindex={true}
>

  <!-- ===== HEADER ===== -->
  <header class="sticky top-0 z-50 bg-brand-500" id="site-header">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16 lg:h-20">
        <!-- Logo -->
        <a href="/" class="flex-shrink-0">
          <img
            src="/images/logos/therapysupport-new.png"
            alt="Therapy Support"
            class="h-8 lg:h-10 w-auto brightness-0 invert"
          />
        </a>

        <!-- Desktop Nav -->
        <nav class="hidden lg:flex items-center gap-1" aria-label="Nawigacja główna">
          {mainNavigation.map((item) => (
            <a
              href={item.href}
              class="px-3 py-2 text-sm font-medium text-brand-100 hover:text-white rounded-lg transition-colors"
              {...(item.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
            >
              {item.label}
            </a>
          ))}
        </nav>

        <a
          href="https://app.aitherapy.support"
          target="_blank"
          rel="noopener noreferrer"
          class="hidden lg:inline-flex items-center px-5 py-2 rounded-full bg-accent-400 text-brand-500 font-bold text-sm hover:bg-accent-300 transition-colors"
        >
          Logowanie
        </a>

        <!-- Mobile toggle -->
        <button
          type="button"
          class="lg:hidden p-2 text-white hover:text-accent-400 transition-colors"
          id="mobile-menu-toggle"
          aria-label="Otwórz menu"
        >
          <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile menu -->
    <div class="hidden lg:hidden bg-brand-600 border-t border-brand-700" id="mobile-menu">
      <nav class="px-4 py-3 space-y-1">
        {mainNavigation.map((item) => (
          <a
            href={item.href}
            class="block px-3 py-2.5 text-sm font-medium text-brand-100 hover:text-white rounded-lg transition-colors"
            {...(item.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
          >
            {item.label}
          </a>
        ))}
        <div class="pt-2 border-t border-brand-700">
          <a
            href="https://app.aitherapy.support"
            target="_blank"
            rel="noopener noreferrer"
            class="block w-full text-center px-5 py-2.5 mt-1 rounded-full bg-accent-400 text-brand-500 font-bold text-sm"
          >
            Logowanie
          </a>
        </div>
      </nav>
    </div>
  </header>

  <main>

    <!-- ===== HERO ===== -->
    <section class="relative overflow-hidden bg-surface">
      <!-- Decorative blobs -->
      <div
        class="absolute top-0 right-0 w-96 h-96 rounded-full bg-accent-400/15 blur-3xl -translate-y-1/2 translate-x-1/3 pointer-events-none"
        aria-hidden="true"
      ></div>
      <div
        class="absolute bottom-0 left-0 w-80 h-80 rounded-full bg-navy-700/10 blur-3xl translate-y-1/3 -translate-x-1/4 pointer-events-none"
        aria-hidden="true"
      ></div>

      <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 sm:py-32 lg:py-40">
        <div class="max-w-3xl mx-auto text-center">

          <!-- Badge -->
          <span class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/60 backdrop-blur-sm border border-white/80 text-slate-500 text-sm font-medium mb-8">
            <span class="w-2 h-2 rounded-full bg-accent-400 animate-pulse"></span>
            Wsparcie pracy klinicznej i zaplecza organizacyjnego
          </span>

          <!-- H1 — Playfair Display -->
          <h1 class="font-display text-4xl sm:text-5xl lg:text-6xl font-bold tracking-tight leading-tight text-neutral-900">
            Platforma dla Terapeutów
            <span class="relative inline-block text-brand-500 ml-2">
              CBT
              <span class="absolute -bottom-1 left-0 right-0 h-1 bg-accent-400 rounded-full"></span>
            </span>
          </h1>

          <!-- Description -->
          <p class="mt-8 text-lg sm:text-xl text-slate-500 leading-relaxed max-w-2xl mx-auto">
            Od wstępnej konsultacji i wywiadu, przez konceptualizację i plan terapii,
            aż po notatki z sesji — całość w jednym, bezpiecznym miejscu,
            z odpowiedzialnym wsparciem AI.
          </p>
          <p class="mt-3 text-lg text-slate-500 font-medium">
            Jasny obraz pacjenta. Pewniejsze decyzje kliniczne. Mniej dokumentacji.
          </p>

          <!-- CTAs -->
          <div class="mt-10 flex flex-col sm:flex-row items-center justify-center gap-4">
            <a
              href="https://app.aitherapy.support/betatester"
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-2 px-8 py-4 rounded-full bg-accent-400 text-brand-500 font-bold text-base shadow-lg hover:bg-accent-300 hover:shadow-xl transition-all"
            >
              Zgłoś się do beta testów
              <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
              </svg>
            </a>
            <a
              href="/funkcjonalnosci/"
              class="inline-flex items-center gap-2 px-8 py-4 rounded-full bg-white text-brand-500 font-semibold text-base border border-brand-100 hover:border-brand-500 shadow-sm hover:shadow-md transition-all"
            >
              Poznaj funkcjonalności
            </a>
          </div>

          <!-- Quick stats strip -->
          <div class="mt-16 grid grid-cols-3 gap-6 max-w-lg mx-auto border-t border-brand-500/10 pt-10">
            {[
              { num: '10–15h', label: 'oszczędności / miesiąc' },
              { num: '30s', label: 'notatka z sesji' },
              { num: 'RODO', label: '100% zgodność' },
            ].map((s) => (
              <div class="text-center">
                <p class="text-2xl font-bold text-brand-500">{s.num}</p>
                <p class="text-xs text-slate-500 mt-1">{s.label}</p>
              </div>
            ))}
          </div>

        </div>
      </div>
    </section>

    <!-- ===== PROBLEM ===== -->
    <section class="py-20 lg:py-28 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="max-w-3xl mx-auto text-center mb-12 lg:mb-16">
          <span class="inline-flex items-center px-3 py-1 rounded-full bg-red-50 text-red-600 text-sm font-medium mb-4">
            Problem Terapeuty
          </span>
          <h2 class="font-display text-3xl sm:text-4xl lg:text-5xl font-bold text-neutral-900">
            Niewidzialna Praca
          </h2>
          <p class="mt-4 text-lg text-slate-500 leading-relaxed">
            Dokumentacja, archiwizacja, planowanie sesji, przygotowanie do superwizji,
            konceptualizacja, fakturowanie, SMS-y do pacjentów — to wszystko zabiera czas.
            <br /><br />
            My go oddajemy. Na terapię, rozwój i to, co napędza.
          </p>
          <p class="mt-3 text-slate-500">
            Zapytaliśmy. Codzienne rozmowy z terapeutami kształtują to, co budujemy.
          </p>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 max-w-4xl mx-auto">
          {[
            { value: '100', label: 'sesji miesięcznie' },
            { value: '20', label: 'minut pracy niewidzialnej na 1 sesję' },
            { value: '20', label: 'godzin miesięcznie na administracji' },
          ].map((stat) => (
            <div class="text-center p-8 rounded-2xl bg-slate-50 border border-gray-100 hover:border-brand-100 hover:shadow-sm transition-all">
              <p class="text-5xl lg:text-6xl font-extrabold text-brand-500">{stat.value}</p>
              <p class="mt-2 text-slate-500 font-medium">{stat.label}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- ===== FEATURES ===== -->
    <section class="py-20 lg:py-28 bg-slate-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="max-w-3xl mx-auto text-center mb-12 lg:mb-16">
          <h2 class="font-display text-3xl sm:text-4xl lg:text-5xl font-bold text-neutral-900">
            Funkcjonalności dopasowane<br class="hidden sm:block" /> do pracy terapeuty
          </h2>
          <p class="mt-4 text-lg text-slate-500 leading-relaxed">
            Lepsza praca kliniczna, mniej administracji.
          </p>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-6">
          {features.map((feature, i) => (
            <div
              class:list={[
                'bg-white rounded-2xl border border-gray-100 p-6 lg:p-8 shadow-sm hover:shadow-md hover:-translate-y-0.5 transition-all group',
                i < 2 ? 'lg:col-span-3' : 'lg:col-span-2',
              ]}
            >
              <span class="text-4xl mb-4 block">{feature.emoji}</span>
              <h3 class="text-xl font-bold text-neutral-900 mb-2 group-hover:text-brand-500 transition-colors">
                {feature.title}
              </h3>
              <p class="text-slate-500 leading-relaxed">{feature.description}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- ===== TESTIMONIALS ===== -->
    <section class="py-20 lg:py-28 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="max-w-3xl mx-auto text-center mb-12 lg:mb-16">
          <span class="inline-flex items-center px-3 py-1 rounded-full bg-brand-50 text-brand-500 text-sm font-medium mb-4">
            Opinie
          </span>
          <h2 class="font-display text-3xl sm:text-4xl lg:text-5xl font-bold text-neutral-900">
            Czego potrzebują terapeuci?
          </h2>
          <p class="mt-4 text-lg text-slate-500 leading-relaxed">
            Wysłuchaliśmy potrzeb profesjonalistów zdrowia psychicznego
            i stworzyliśmy rozwiązanie odpowiadające na realne wyzwania.
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 lg:gap-8">
          {testimonials.map((t) => (
            <div class="bg-white rounded-2xl border border-gray-100 p-6 shadow-sm hover:shadow-md transition-shadow">
              <!-- Stars -->
              <div class="flex gap-1 mb-4">
                {Array.from({ length: 5 }).map((_, i) => (
                  <svg
                    class:list={['w-5 h-5', i < t.rating ? 'text-yellow-400' : 'text-gray-200']}
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                  </svg>
                ))}
              </div>
              <!-- Quote -->
              <blockquote class="text-slate-500 leading-relaxed mb-6 italic">
                &bdquo;{t.quote}&rdquo;
              </blockquote>
              <!-- Author -->
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-brand-50 flex items-center justify-center text-brand-500 font-bold text-sm">
                  {t.name.charAt(0)}
                </div>
                <div>
                  <p class="font-semibold text-neutral-900 text-sm">{t.name}</p>
                  <p class="text-slate-500 text-xs">{t.role}</p>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- ===== FAQ ===== -->
    <section class="py-20 lg:py-28 bg-slate-50">
      <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12 lg:mb-16">
          <h2 class="font-display text-3xl sm:text-4xl lg:text-5xl font-bold text-neutral-900">
            O co pytacie?
          </h2>
          <p class="mt-4 text-lg text-slate-500">
            Nie znalazłeś odpowiedzi?{' '}
            <a href="/kontakt/" class="text-brand-500 hover:underline font-medium">Napisz do nas.</a>
          </p>
        </div>

        <div class="space-y-3" id="faq-list">
          {faqItems.map((item, idx) => (
            <div class="border border-gray-200 rounded-xl overflow-hidden bg-white" data-faq-item>
              <button
                type="button"
                class="flex items-center justify-between w-full px-6 py-4 text-left hover:bg-slate-50 transition-colors"
                data-faq-btn
                aria-expanded="false"
              >
                <span class="font-semibold text-neutral-900 pr-4">{item.question}</span>
                <svg
                  class="w-5 h-5 text-brand-500 flex-shrink-0 transition-transform duration-200"
                  data-faq-arrow
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                </svg>
              </button>
              <div class="hidden px-6 pb-5" data-faq-content>
                <p class="text-slate-500 leading-relaxed">{item.answer}</p>
              </div>
            </div>
          ))}
        </div>

        <div class="mt-10 text-center">
          <a
            href="/kontakt/"
            class="inline-flex items-center gap-2 px-6 py-3 rounded-full border-2 border-brand-500 text-brand-500 font-semibold hover:bg-brand-50 transition-colors"
          >
            Napisz wiadomość
          </a>
        </div>
      </div>
    </section>

    <!-- ===== BLOG ===== -->
    {latestPosts.length > 0 && (
      <section class="py-20 lg:py-28 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="max-w-3xl mx-auto text-center mb-12 lg:mb-16">
            <h2 class="font-display text-3xl sm:text-4xl lg:text-5xl font-bold text-neutral-900">
              Blog
            </h2>
            <p class="mt-4 text-lg text-slate-500 leading-relaxed">
              Terapia, warsztat, technologia. Piszemy o tym, nad czym pracujemy i dlaczego.
            </p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 lg:gap-8">
            {latestPosts.map((post) => (
              <a
                href={`/blog/${post.slug}/`}
                class="group bg-white rounded-2xl border border-gray-100 overflow-hidden shadow-sm hover:shadow-md transition-shadow"
              >
                {post.data.heroImage && (
                  <div class="aspect-[16/9] overflow-hidden bg-gray-100">
                    <img
                      src={post.data.heroImage}
                      alt={post.data.title}
                      class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                    />
                  </div>
                )}
                <div class="p-6">
                  <p class="text-sm text-brand-500 font-medium mb-2">{post.data.category}</p>
                  <h3 class="text-lg font-bold text-neutral-900 group-hover:text-brand-500 transition-colors line-clamp-2 mb-3">
                    {post.data.title}
                  </h3>
                  <p class="text-slate-500 text-sm leading-relaxed line-clamp-3 mb-4">
                    {post.data.description}
                  </p>
                  <div class="flex items-center justify-between text-sm text-gray-400">
                    <span>{post.data.author}</span>
                    <time datetime={post.data.pubDate.toISOString()}>
                      {post.data.pubDate.toLocaleDateString('pl-PL', {
                        day: 'numeric',
                        month: 'short',
                        year: 'numeric',
                      })}
                    </time>
                  </div>
                </div>
              </a>
            ))}
          </div>

          <div class="mt-10 text-center">
            <a
              href="/blog/"
              class="inline-flex items-center gap-2 px-6 py-3 rounded-full border-2 border-brand-500 text-brand-500 font-semibold hover:bg-brand-50 transition-colors"
            >
              Wszystkie wpisy
            </a>
          </div>
        </div>
      </section>
    )}

    <!-- ===== CTA ===== -->
    <section class="py-20 lg:py-28 bg-surface relative overflow-hidden">
      <div
        class="absolute top-0 right-0 w-80 h-80 rounded-full bg-accent-400/15 blur-3xl -translate-y-1/3 translate-x-1/4 pointer-events-none"
        aria-hidden="true"
      ></div>
      <div
        class="absolute bottom-0 left-0 w-64 h-64 rounded-full bg-navy-700/10 blur-3xl translate-y-1/3 -translate-x-1/4 pointer-events-none"
        aria-hidden="true"
      ></div>

      <div class="relative max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="font-display text-3xl sm:text-4xl lg:text-5xl font-bold text-neutral-900">
          Dołącz do beta testów
        </h2>
        <p class="mt-6 text-lg text-slate-500 leading-relaxed">
          Jesteś terapeutą / terapeutką CBT?<br />
          Sprawdź, jak platforma wspiera Twoją codzienną pracę.<br />
          Podsumowania sesji, które porządkują materiał kliniczny.<br />
          Cele terapii widoczne na każdym etapie.<br />
          Kalendarz, przedpłaty, notatki — administracja, która nie przeszkadza.
        </p>
        <p class="mt-3 text-lg font-semibold text-neutral-900">
          Odzyskaj czas dla siebie i swoich pacjentów.
        </p>

        <div class="mt-10 flex flex-col sm:flex-row items-center justify-center gap-4">
          <a
            href="https://app.aitherapy.support/betatester"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-8 py-4 rounded-full bg-brand-500 text-white font-bold text-base hover:bg-brand-600 shadow-lg transition-all"
          >
            Zgłoś się do beta testów
          </a>
          <a
            href="/zapisy-na-sesje-feedbackowe/"
            class="inline-flex items-center gap-2 px-8 py-4 rounded-full bg-white text-brand-500 font-semibold text-base border border-brand-100 hover:border-brand-500 shadow-sm hover:shadow-md transition-all"
          >
            Umów sesję feedbackową
          </a>
        </div>
      </div>
    </section>

  </main>

  <!-- ===== FOOTER ===== -->
  <footer class="bg-brand-700 text-brand-100">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 lg:py-16">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12">
        <!-- Brand -->
        <div class="lg:col-span-1">
          <a href="/" class="inline-block mb-4">
            <img
              src="/images/logos/therapysupport-new.png"
              alt="Therapy Support"
              class="h-10 w-auto brightness-0 invert opacity-90"
            />
          </a>
          <p class="text-sm text-brand-100/70 leading-relaxed">
            Zintegrowana Platforma dla Terapeutów CBT.<br />Nowy standard w psychoterapii.
          </p>
        </div>

        <!-- Nav col 1 -->
        <div>
          <h3 class="text-white font-semibold text-sm mb-4">Nawigacja</h3>
          <ul class="space-y-2.5">
            {mainNavigation.slice(0, 4).map((item) => (
              <li>
                <a
                  href={item.href}
                  class="text-sm text-brand-100/70 hover:text-white transition-colors"
                  {...(item.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
                >
                  {item.label}
                </a>
              </li>
            ))}
          </ul>
        </div>

        <!-- Nav col 2 -->
        <div>
          <h3 class="text-white font-semibold text-sm mb-4">Informacje</h3>
          <ul class="space-y-2.5">
            {mainNavigation.slice(4).map((item) => (
              <li>
                <a
                  href={item.href}
                  class="text-sm text-brand-100/70 hover:text-white transition-colors"
                  {...(item.external ? { target: '_blank', rel: 'noopener noreferrer' } : {})}
                >
                  {item.label}
                </a>
              </li>
            ))}
          </ul>
        </div>
      </div>

      <!-- EU notice -->
      <div class="mt-12 pt-8 border-t border-brand-600">
        <p class="text-xs text-brand-100/40 leading-relaxed max-w-4xl">
          Projekt &bdquo;Platforma Startowa Unicorn Hub &ndash; Edycja II&rdquo; współfinansowany ze środków Unii Europejskiej
          w ramach działania 1.1 Platformy Startowe dla nowych pomysłów Programu Fundusze Europejskie dla Polski Wschodniej 2021-2027.
        </p>
      </div>

      <!-- Copyright -->
      <div class="mt-6 pt-6 border-t border-brand-600 flex flex-col sm:flex-row justify-between items-center gap-4">
        <p class="text-xs text-brand-100/40">
          &copy; {currentYear} Therapy Support. Wszelkie prawa zastrzeżone.
        </p>
        <div class="flex flex-wrap items-center justify-center gap-4">
          {[
            { href: '/regulamin/', label: 'Regulamin' },
            { href: '/polityka-prywatnosci/', label: 'Polityka prywatności' },
            { href: '/cookies/', label: 'Cookies' },
            { href: '/kontakt/', label: 'Kontakt' },
          ].map((link) => (
            <a href={link.href} class="text-xs text-brand-100/40 hover:text-white transition-colors">
              {link.label}
            </a>
          ))}
        </div>
      </div>
    </div>
  </footer>

</BaseLayout>

<script is:inline>
  // Mobile menu
  const toggle = document.getElementById('mobile-menu-toggle');
  const menu = document.getElementById('mobile-menu');
  if (toggle && menu) {
    toggle.addEventListener('click', () => {
      menu.classList.toggle('hidden');
    });
  }

  // FAQ accordion
  document.querySelectorAll('[data-faq-btn]').forEach((btn) => {
    btn.addEventListener('click', () => {
      const item = btn.closest('[data-faq-item]');
      const content = item.querySelector('[data-faq-content]');
      const arrow = item.querySelector('[data-faq-arrow]');
      const isOpen = !content.classList.contains('hidden');

      content.classList.toggle('hidden');
      arrow.classList.toggle('rotate-180');
      btn.setAttribute('aria-expanded', isOpen ? 'false' : 'true');
    });
  });
</script>
